<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="css/sign-in-style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js"></script>
    <title>Log in</title>

  </head>
  <body>
    <section class="Form my-4 mx-5">
      <div class="container">
        <div class="row g-0">
          <div class="col-lg-5">
            <img src="../img/pages.jpg" class="img-fluid">
          </div>
          <div class="col-lg-7 px-5 pt-5">
            <h1 class="font-weight-bold py-3">Log in</h1>
            <form id="login-form">
              <div class="form-row">
                <div class="col-lg-7">
                  <input type="email" id="email" placeholder="Email Address" class="form-control my-3 p-4" required>
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-7">
                  <input type="password" id="password" placeholder="password" class="form-control my-3 p-4" required>
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-7">
                  <div class="g-recaptcha" id="grecaptcha" data-sitekey="6LebMGkgAAAAAPb46NvPkm3IMO8AmBTs8mawuzpp"></div>
                  <script>
                    var form = document.getElementById('login-form');
                    form.addEventListener("submit", function(event){
                        if (grecaptcha.getResponse() === '') {                            
                          event.preventDefault();
                          alert('Please check the recaptcha');
                        }
                      }
                    , false);
                  </script>
                </div>
              </div>
              <div class="form-row">
                <div class="col-lg-7">
                  <input type="submit" id="loginButton" class="loginButton mt-3 mb-5">
                </div>
              </div>
              <a href="./reset-password-request">Forgot password</a>
              <p>Don't have an account? <a href="./sign-up">Register here</a></p>
              <script>
                const signupForm = document.getElementById('login-form');
                const signupBtn = document.getElementById('loginButton');
          
          
                signupForm.onsubmit = function() {myFunction()};
                function myFunction() {
      
      
                    signinFunc()
                  }
          
                function signinFunc() {
          

                    var email = signupForm.email.value
                    var password = signupForm.password.value
                    var response = grecaptcha.getResponse()
                    console.log(response)
          
                    var json = {
                            'email':email,
                            'password': password,
                            'response':response
                          }
          
          
                    $.ajax({
                      url: "/sign-in-parameters",
                      type: "POST",
                      data: json,
                      success: function (response) {
                        $("#resbox").append("<br>");
                        $("#resbox").append(response);
                      },
                      error: function (xhr, status, errmsg) {  // XHR - XMLHttpRequest  
                        alert(errmsg + "  " + status);
                      }
                    });
            
                }
              </script>
            </form>
            
          </div>
        </div>

      </div>
    </section>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
  </body>
</html>